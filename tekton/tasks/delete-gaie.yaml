apiVersion: tekton.dev/v1
kind: Task
metadata:
  name: delete-gaie
spec:
  description: |
    Delete Kubernetes Gateway API Inference Extension configuration
  params:
    - { name: namespace, type: string }
    - { name: modelLabel, type: string }
    - { name: debug, type: string, default: "false" }

  steps:
    - name: dry-run
      when:
        - input: $(params.debug)
          operator: in
          values: ["true", "True"]
      image: alpine:3.20
      script: |
        #!/bin/sh
        set -eu
        echo "delete-gaie called"

    - name: delete
      when:
        - input: $(params.debug)
          operator: in
          values: ["false", "False",]
      ref: 
        name: helm-delete
      params:
        - { name: namespace, value: "$(params.namespace)" }
        - { name: releaseName, value: "$(params.modelLabel)-gaie"}